{
  "$schema": "./action-policy.schema.json",
  "_comment": "Built-in LogOnly action policies. These are compiled into the library.",
  "logonly": {
    "Type": "LogOnly",
    "Description": "Minimal logging - shadow mode with basic info",
    "Tags": [
      "default",
      "shadow"
    ],
    "LogLevel": "Information",
    "LogFullEvidence": false,
    "AddResponseHeaders": false,
    "AddToContextItems": true,
    "WouldBlockThreshold": 0.85
  },
  "shadow": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Shadow mode with response headers for debugging",
    "Tags": [
      "production",
      "shadow",
      "headers"
    ],
    "AddResponseHeaders": true,
    "IncludeDetailedHeaders": false
  },
  "debug": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Full debug logging with all evidence and headers",
    "Tags": [
      "development",
      "debug"
    ],
    "LogLevel": "Debug",
    "LogFullEvidence": true,
    "AddResponseHeaders": true,
    "IncludeDetailedHeaders": true
  },
  "full-log": {
    "Type": "LogOnly",
    "Extends": "debug",
    "Description": "Maximum visibility - debug logging with all response headers. Great for demos.",
    "Tags": [
      "demo",
      "debug",
      "development"
    ],
    "LogLevel": "Debug",
    "LogFullEvidence": true,
    "AddResponseHeaders": true,
    "IncludeDetailedHeaders": true,
    "AddToContextItems": true,
    "WouldBlockThreshold": 0.7
  },
  "shadow-production": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Production shadow mode - logs what WOULD be blocked without blocking. No headers exposed.",
    "Tags": [
      "production",
      "shadow",
      "testing"
    ],
    "LogLevel": "Information",
    "LogFullEvidence": false,
    "AddResponseHeaders": false,
    "AddToContextItems": true,
    "WouldBlockThreshold": 0.7,
    "MetricName": "bot_detection_shadow"
  },
  "log-to-file": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Writes detection events to JSON Lines files for playback and forensic analysis",
    "Tags": [
      "production",
      "audit",
      "forensics"
    ],
    "LogLevel": "Information",
    "LogFullEvidence": true,
    "AddToContextItems": true,
    "LogDirectory": "logs/bot-detection",
    "LogFilePattern": "detections-{date}.jsonl",
    "LogOnlyBots": true,
    "LogMinConfidence": 0.5,
    "LogRetainFiles": 30
  },
  "forward-to-honeypot": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Forwards detection data to honeypot/trap service. Detection runs, request passes through.",
    "Tags": [
      "honeypot",
      "security",
      "research"
    ],
    "LogLevel": "Debug",
    "LogFullEvidence": true,
    "AddToContextItems": true,
    "ForwardUrl": "http://honeypot:8080/trap",
    "ForwardMethod": "POST",
    "ForwardTimeoutMs": 5000,
    "ForwardAsync": true,
    "ForwardIncludeHeaders": true,
    "ForwardIncludeReasons": true
  },
  "forward-to-analytics": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Fire-and-forget forwarding to SIEM/analytics endpoint",
    "Tags": [
      "analytics",
      "siem",
      "monitoring"
    ],
    "LogLevel": "Information",
    "AddToContextItems": true,
    "ForwardUrl": "http://analytics:9000/events/bot-detection",
    "ForwardMethod": "POST",
    "ForwardAsync": true,
    "ForwardIncludeHeaders": false,
    "ForwardIncludeReasons": true
  },
  "passthrough-internal": {
    "Type": "LogOnly",
    "Extends": "logonly",
    "Description": "Allows known-good traffic through while still logging. Use for false positive exceptions.",
    "Tags": [
      "internal",
      "exceptions",
      "false-positives"
    ],
    "LogLevel": "Information",
    "LogFullEvidence": true,
    "AddToContextItems": true,
    "PassthroughUserAgents": [
      "InternalMonitor/.*",
      "HealthCheck/.*"
    ],
    "PassthroughIps": [
      "10.0.0.0/8",
      "192.168.0.0/16",
      "172.16.0.0/12"
    ]
  }
}
