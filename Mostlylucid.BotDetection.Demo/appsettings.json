{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Mostlylucid.BotDetection": "Debug",
      "Mostlylucid.BotDetection.Services.BotListUpdateService": "Information"
    }
  },
  "AllowedHosts": "*",

  "BotDetection": {
    "BotThreshold": 0.7,
    "EnableTestMode": true,
    "EnableUserAgentDetection": true,
    "EnableHeaderAnalysis": true,
    "EnableIpDetection": true,
    "EnableBehavioralAnalysis": true,
    "EnableLlmDetection": true,

    "ResponseHeaders": {
      "Enabled": true,
      "HeaderPrefix": "X-Bot-",
      "IncludePolicyName": true,
      "IncludeConfidence": true,
      "IncludeDetectors": true,
      "IncludeProcessingTime": true,
      "IncludeBotName": true,
      "IncludeFullJson": false
    },

    "FastPath": {
      "Enabled": true,
      "MaxParallelDetectors": 8,
      "EnableWaveParallelism": true,
      "WaveTimeoutMs": 500,
      "FastPathTimeoutMs": 1000,
      "EarlyExitThreshold": 0.99,
      "SkipSlowPathThreshold": 0.0,
      "SlowPathTriggerThreshold": 0.0,
      "AlwaysRunFullOnPaths": ["/bot-test"],
      "SlowPathDetectors": [
        { "Name": "ONNX Detector", "Signal": "AiClassificationCompleted", "ExpectedLatencyMs": 5, "Wave": 1, "Category": "AI", "Weight": 2.0 },
        { "Name": "Inconsistency Detector", "Signal": "InconsistencyUpdated", "ExpectedLatencyMs": 2, "Wave": 1, "Category": "Inconsistency", "Weight": 1.5 },
        { "Name": "Version Age Detector", "Signal": "VersionAgeAnalyzed", "ExpectedLatencyMs": 1, "Wave": 1, "Category": "VersionAge", "Weight": 1.0 }
      ]
    },

    "VersionAge": {
      "Enabled": true,
      "CheckBrowserVersion": true,
      "CheckOsVersion": true,
      "MaxBrowserVersionAge": 10
    },

    "AiDetection": {
      "Provider": "Onnx",
      "TimeoutMs": 2000,
      "MaxConcurrentRequests": 5,
      "Ollama": {
        "Endpoint": "http://localhost:11434",
        "Model": "gemma3:1b",
        "UseJsonMode": true
      },
      "Onnx": {
        "ModelPath": null,
        "ModelDownloadUrl": "",
        "AutoDownloadModel": true,
        "UseGpu": false,
        "EnableHeuristicFallback": true
      }
    },

    "MaxRequestsPerMinute": 60,
    "CacheDurationSeconds": 0,
    "EnableBackgroundUpdates": true,
    "UpdateIntervalHours": 24,
    "StartupDelaySeconds": 2,
    "LogDetailedReasons": true,
    "LogPerformanceMetrics": true,

    "Behavioral": {
      "ApiKeyHeader": "X-Api-Key",
      "ApiKeyRateLimit": 120,
      "UserIdHeader": "X-User-Id",
      "UserIdClaim": "sub",
      "UserRateLimit": 180,
      "EnableAnomalyDetection": true,
      "SpikeThresholdMultiplier": 5.0,
      "NewPathAnomalyThreshold": 0.8
    },

    "ClientSide": {
      "Enabled": true,
      "TokenSecret": "demo-secret-key-change-in-production",
      "TokenLifetimeSeconds": 300,
      "FingerprintCacheDurationSeconds": 1800,
      "CollectWebGL": true,
      "CollectCanvas": true,
      "MinIntegrityScore": 70,
      "HeadlessThreshold": 0.5
    },

    "DataSources": {
      "IsBot": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/omrilotan/isbot/main/src/patterns.json"
      },
      "Matomo": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/matomo-org/device-detector/master/regexes/bots.yml"
      },
      "CrawlerUserAgents": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/monperrus/crawler-user-agents/master/crawler-user-agents.json"
      },
      "AwsIpRanges": {
        "Enabled": true,
        "Url": "https://ip-ranges.amazonaws.com/ip-ranges.json"
      },
      "GcpIpRanges": {
        "Enabled": true,
        "Url": "https://www.gstatic.com/ipranges/cloud.json"
      },
      "AzureIpRanges": {
        "Enabled": false,
        "Url": ""
      },
      "CloudflareIpv4": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v4"
      },
      "CloudflareIpv6": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v6"
      }
    }
  }
}
