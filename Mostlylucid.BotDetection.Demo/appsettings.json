{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Mostlylucid.BotDetection": "Debug",
      "Mostlylucid.BotDetection.Services.BotListUpdateService": "Information"
    }
  },
  "AllowedHosts": "*",

  "BotDetection": {
    "BotThreshold": 0.7,
    "EnableTestMode": true,
    "EnableUserAgentDetection": true,
    "EnableHeaderAnalysis": true,
    "EnableIpDetection": true,
    "EnableBehavioralAnalysis": true,
    "EnableLlmDetection": true,

    "AiDetection": {
      "Provider": "Onnx",
      "TimeoutMs": 2000,
      "MaxConcurrentRequests": 5,
      "Ollama": {
        "Endpoint": "http://localhost:11434",
        "Model": "gemma3:1b",
        "UseJsonMode": true
      },
      "Onnx": {
        "ModelPath": null,
        "ModelDownloadUrl": "",
        "AutoDownloadModel": true,
        "UseGpu": false,
        "EnableHeuristicFallback": true
      }
    },

    "MaxRequestsPerMinute": 60,
    "CacheDurationSeconds": 300,
    "EnableBackgroundUpdates": true,
    "UpdateIntervalHours": 24,
    "StartupDelaySeconds": 2,
    "LogDetailedReasons": true,
    "LogPerformanceMetrics": true,

    "Behavioral": {
      "ApiKeyHeader": "X-Api-Key",
      "ApiKeyRateLimit": 120,
      "UserIdHeader": "X-User-Id",
      "UserIdClaim": "sub",
      "UserRateLimit": 180,
      "EnableAnomalyDetection": true,
      "SpikeThresholdMultiplier": 5.0,
      "NewPathAnomalyThreshold": 0.8
    },

    "ClientSide": {
      "Enabled": true,
      "TokenSecret": "demo-secret-key-change-in-production",
      "TokenLifetimeSeconds": 300,
      "FingerprintCacheDurationSeconds": 1800,
      "CollectWebGL": true,
      "CollectCanvas": true,
      "MinIntegrityScore": 70,
      "HeadlessThreshold": 0.5
    },

    "_comment_ActionPolicies": "The following policies are BUILT-IN to the BotDetection library. You don't need to define them - they're available by name. Uncomment any to customize/override.",

    "ActionPolicies": {
      "_comment": "Built-in policies available without configuration: full-log, log-to-file, forward-to-honeypot, forward-to-analytics, passthrough-internal, shadow-production, strict-block, debug-block, stealth-throttle",

      "_example_custom_honeypot": {
        "_comment": "Example: Override the forward-to-honeypot built-in with your own URL",
        "Type": "LogOnly",
        "Enabled": false,
        "ForwardUrl": "http://my-honeypot:8080/trap",
        "ForwardHeaders": { "X-Api-Key": "my-secret" }
      },

      "_example_custom_passthrough": {
        "_comment": "Example: Add your own exception patterns for false positives",
        "Type": "LogOnly",
        "Enabled": false,
        "PassthroughUserAgents": ["MyCompanyBot/.*"],
        "PassthroughIps": ["203.0.113.0/24"]
      }
    },

    "DataSources": {
      "IsBot": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/omrilotan/isbot/main/src/patterns.json"
      },
      "Matomo": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/matomo-org/device-detector/master/regexes/bots.yml"
      },
      "CrawlerUserAgents": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/monperrus/crawler-user-agents/master/crawler-user-agents.json"
      },
      "AwsIpRanges": {
        "Enabled": true,
        "Url": "https://ip-ranges.amazonaws.com/ip-ranges.json"
      },
      "GcpIpRanges": {
        "Enabled": true,
        "Url": "https://www.gstatic.com/ipranges/cloud.json"
      },
      "AzureIpRanges": {
        "Enabled": false,
        "Url": ""
      },
      "CloudflareIpv4": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v4"
      },
      "CloudflareIpv6": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v6"
      }
    }
  }
}
